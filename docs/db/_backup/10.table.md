# 테이블 정의서

> inspig 주간/월간 리포트 관련 테이블 정의

---

## 1. 원본 테이블 (기존)

### 1.1 주요 테이블 목록

| 테이블명 | 설명 | 주요 컬럼 |
|----------|------|----------|
| `TA_FARM` | 농장 정보 | FARM_NO, FARM_NM, COMPANY_CD, USE_YN |
| `TA_SYS_CONFIG` | 시스템 설정 (공통) | [21.insTable.md](21.insTable.md) 참조 |
| `TA_FARM_STATS_INFO` | 농장 서비스/통계 정보 | FARM_NO, INSPIG_YN, INSPIG_SDATE, EKAPE_YN |
| `TB_MODON` | 모돈 정보 | FARM_NO, PIG_NO, STATUS_CD, IN_DT, OUT_DT |
| `TB_MODON_WK` | 모돈 작업 정보 | FARM_NO, PIG_NO, WK_DT, WK_GUBUN, SANCHA |
| `TB_GYOBAE` | 교배 정보 | FARM_NO, PIG_NO, WK_DT, METHOD_1~3 |
| `TB_EU` | 이유 정보 | FARM_NO, PIG_NO, WK_DT, DUSU, DUSU_SU, ILRYUNG |
| `TB_SAGO` | 임신사고 정보 | FARM_NO, PIG_NO, WK_DT, SAGO_GUBUN_CD |
| `TB_PLAN_MODON` | 예정작업 정보 | FARM_NO, PASS_DAY, MODON_STATUS_CD |
| `TC_CODE_SYS` | 공통 코드 | CODE, PCODE, CNAME |
| `TM_LPD_DATA` | 도축(출하) 정보 | FARM_NO, DOCHUK_DT, NET_KG, BACK_DEPTH, MEAT_QUALITY |
| `TC_FARM_CONFIG` | 농가별 설정 정보 | FARM_NO, CODE, CVALUE |

### 1.2 작업구분 코드 (WK_GUBUN)

| 코드 | 설명 | 관련 테이블 |
|------|------|-------------|
| `G` | 교배 (Gyobae) | TB_GYOBAE |
| `B` | 분만 (Bunman) | TB_BUNMAN |
| `E` | 이유 (Eu) | TB_EU |
| `F` | 임신사고 (Fail) | TB_SAGO |
| `A` | 전입 | TB_MODON |
| `Z` | 도폐사 | TB_MODON |

### 1.3 도축(출하) 테이블 (TM_LPD_DATA)

| 컬럼명 | 설명 | 비고 |
|--------|------|------|
| `FARM_NO` | 농장번호 | PK |
| `DOCHUK_DT` | 도축일 | PK (VARCHAR2, 'YYYY-MM-DD') |
| `DOCHUK_NO` | 도체번호 | PK |
| `FACTORY_CD` | 작업장명 | PK |
| `SEX_GUBUN` | 성별 구분 | |
| `NET_KG` | 지육체중(도체중) | NUMBER(8,2) |
| `BACK_DEPTH` | 등지방두께 | NUMBER(8,2) |
| `OO_JUDGEMENT` | 예비규격등급 | |
| `UU_JUDGEMENT` | 예비육질등급(1차등급) | |
| `MEAT_QUALITY` | 육질(최종등급) | 1+, 1, 2, 등외 등 |
| `MEAT_COLOR` | 육색 | |
| `FAT_COLOR` | 지방색 | |
| `LOIN_DIAMETER` | 등심직경 | |
| `AU_PRICE` | 경락가 | NUMBER(10,2) |
| `EKAPE_ABATT_CODE` | 작업장(도축장)코드 | 축평원 연계 |
| `EKAPE_ISSUE_NO` | 확인서발급번호 | 축평원 연계 |

### 1.4 농가별 설정 테이블 (TC_FARM_CONFIG)

| 컬럼명 | 설명 | 비고 |
|--------|------|------|
| `FARM_NO` | 농장번호 | PK, FK → TA_FARM |
| `CODE` | 설정코드 | PK (TC_CODE_SYS 참조) |
| `CVALUE` | 설정값 | VARCHAR2(4000) |
| `CVALUE_2` | 보조 설정값 | VARCHAR2(200) |
| `DISPLAY_TYPE` | 출력구분 | |
| `SORT_NO` | 정렬순번 | |
| `USE_YN` | 사용여부 | |

#### 주요 설정코드

| CODE | 설명 | CVALUE 예시 |
|------|------|-------------|
| `901001` | 임신기간 | `114` (일) |
| `901002` | 포유기간 | `21` (일) |
| `901003` | 이유후 교배대기기간 | `7` (일) |
| `901004` | 재귀발정 기간 | `21` (일) |
| `901005` | 교배횟수 기준 | `2` (회) |

### 1.5 농장 서비스/통계 정보 테이블 (TA_FARM_STATS_INFO)

농장별 통계 정보 및 축평원 연계 정보를 관리합니다.

> **인사이트피그플랜 서비스**: [TS_INS_SERVICE](21.insTable.md) 테이블 참조

| 컬럼명 | 데이터타입 | 설명 | 비고 |
|--------|-----------|------|------|
| `FARM_NO` | INTEGER | 농장번호 | PK |
| `MX_GDT` | DATE | 최종교배일 | |
| `MX_BDT` | DATE | 최종분만일 | |
| `MX_SDT` | DATE | 최종사고일 | |
| `MX_EDT` | DATE | 최종이유일 | |
| `EKAPE_YN` | VARCHAR2(1) | 축평원 연계여부 (모돈전입,도폐사,통계) | Y/N |
| `EKAPE_NO` | VARCHAR2(20) | 축평원 연계번호 | |
| `EKAPE_SDATE` | DATE | 축평원 연계시작일 | |
| `EKAPE_FARM_NO` | VARCHAR2(6) | 축평원 농장번호 | |
| `EKAPE_WK_YN` | VARCHAR2(1) | 축평원 연계여부 (생산정보) | Y/N, 기본값 'N' |
| `USE_YN` | VARCHAR2(1) | 사용여부 | 기본값 'Y' |
| `LOG_INS_DT` | DATE | 생성일 | NOT NULL |
| `LOG_UPT_DT` | DATE | 수정일자 | NOT NULL |

---

## 1.6 회원 테이블 (TA_MEMBER)

사용자 정보를 관리하는 테이블입니다. 로그인 시 FARM_NO를 세션에 저장하여 사용합니다.

| 컬럼명 | 데이터타입 | 설명 | 비고 |
|--------|-----------|------|------|
| `MEMBER_ID` | VARCHAR2(40) | 회원아이디 | PK |
| `COMPANY_CD` | INTEGER | 업체코드 | 기본값 0 |
| `SOLE_CD` | INTEGER | 총판코드 | 기본값 0 |
| `AGENT_CD` | INTEGER | 특약점코드 | 기본값 0 |
| `FARM_NO` | INTEGER | 농장번호 | **세션 저장용** |
| `MEMBER_TYPE` | VARCHAR2(6) | 회원구분 | |
| `MEMBER_TYPE_D` | VARCHAR2(6) | 회원상세구분 | |
| `NAME` | VARCHAR2(40) | 사용자명 | |
| `POSITION` | VARCHAR2(200) | 직급 | |
| `EMAIL` | VARCHAR2(100) | 이메일 | |
| `PASSWORD` | VARCHAR2(100) | 비밀번호 | 암호화 저장 |
| `HP_NUM` | VARCHAR2(20) | 핸드폰번호 | |
| `HP_ID` | VARCHAR2(200) | 핸드폰고유아이디 | |
| `LAST_DT` | DATE | 마지막접속일 | |
| `BIGO` | VARCHAR2(200) | 비고 | |
| `USER_OK_CD` | VARCHAR2(20) | 회원승인코드 | |
| `USE_YN` | CHAR(1) | 사용여부 | Y/N |
| `LOG_INS_DT` | DATE | 생성일 | |
| `LOG_INS_ID` | VARCHAR2(40) | 생성자 | |
| `LOG_UPT_DT` | DATE | 수정일자 | |
| `LOG_UPT_ID` | VARCHAR2(40) | 수정자 | |
| `LOGINKEY` | VARCHAR2(2000) | 로그인 인증키 | JWT 토큰 등 |
| `DEPARTMENT` | VARCHAR2(200) | 소속 | |
| `AUTHORITY_NO` | INTEGER | 권한일련번호 | |
| `LOGOUT_DT` | DATE | 탈퇴일 | NULL 가능 |
| `PASSHINT_CD` | VARCHAR2(6) | 비밀번호 힌트코드 | |
| `PASSHINT_VAL` | VARCHAR2(100) | 비밀번호 힌트 값 | |
| `MGN_FARM_AUTHORITH` | NUMBER | 농장관리권한 | |
| `LASTCON_FARM_NO` | VARCHAR2(50) | 마지막 접속 농가/업체 코드 | |
| `LASTJOB_FARM_NO` | VARCHAR2(20) | 마지막 작업 농장번호 | |
| `CLOUD_YN` | VARCHAR2(1) | 클라우드확인제용 | |

#### 회원구분 코드 (MEMBER_TYPE)

| 코드 | 설명 |
|------|------|
| `F` | 농장 (Farm) |
| `C` | 업체 (Company) |
| `A` | 관리자 (Admin) |

---

## 2. 통계 테이블 (신규) - 통합 구조

> **상세 DDL**: [21.insTable.md](21.insTable.md) 참조
>
> **명명 규칙**: 통계 테이블은 `TS_INS_` 접두어를 사용합니다.

### 2.1 테이블 구조 개요

3계층 구조로 리포트 데이터를 통합 관리합니다.

```
┌─────────────────────────────────────────────────────────────┐
│                    TS_INS_MASTER (최상위)                    │
│  - 주/월별 리포트 생성 기준 정보                              │
│  - 대상 농장수, 실행완료 농장수, 생성상태                      │
└─────────────────────────┬───────────────────────────────────┘
                          │ 1:N
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                    TS_INS_WEEK (농장별)                       │
│  - 농장별 리포트 요약 데이터                                  │
│  - 페이지 표시용 집계 수치                                    │
└─────────────────────────┬───────────────────────────────────┘
                          │ 1:N
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                  TS_INS_WEEK_SUB (상세)                       │
│  - 각 팝업별 리스트 데이터                                    │
│  - GUBUN으로 데이터 유형 구분                                 │
└─────────────────────────────────────────────────────────────┘
```

| 테이블명 | 설명 | 용도 |
|----------|------|------|
| `TS_INS_MASTER` | 리포트 생성 마스터 | 주/월별 리포트 생성 기준, 대상수, 완료수 |
| `TS_INS_WEEK` | 농장별 리포트 테이블 | 주간/월간/분기 보고서 요약 데이터 |
| `TS_INS_WEEK_SUB` | 리포트 상세 테이블 | 각 팝업별 리스트 데이터 |

> **DDL, 인덱스, GUBUN 상세 매핑**은 [21.insTable.md](21.insTable.md), **INSERT 예시, 조회 쿼리**는 [22.insQuery.md](22.insQuery.md)를 참조하세요.
